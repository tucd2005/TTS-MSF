<div class="create-class-card">
  <h3 class="title">T·∫°o l·ªõp h·ªçc m·ªõi</h3>
  <hr />
  <form [formGroup]="form" (ngSubmit)="submit()" novalidate>
    <div class="form-row">
      <label>T√™n l·ªõp h·ªçc</label>
      <input type="text" formControlName="className" placeholder="ND: L·ªõp AAAA Kh√≥a BBBB" />
      <div class="error" *ngIf="form.get('className')?.touched && form.get('className')?.invalid">
        <span *ngIf="form.get('className')?.errors?.['required']">T√™n l·ªõp l√† b·∫Øt bu·ªôc.</span>
        <span *ngIf="form.get('className')?.errors?.['maxlength']">T√™n qu√° d√†i.</span>
      </div>
    </div>

    <div class="form-row">
      <label>Th·ªÉ l·ªá l·ªõp h·ªçc</label>
      <textarea formControlName="classRule" rows="5" placeholder="Nh·∫≠p"></textarea>
    </div>

    <div class="members-section">
      <h4>Th√™m th√†nh vi√™n</h4>

      <div class="add-member-row"style="padding-bottom: 10px;" >
        <div class="col">
          <label>Email/username</label>
          <input type="text" formControlName="memberEmail" placeholder="Nh·∫≠p" />
          <div
            class="error"
            *ngIf="form.get('memberEmail')?.touched && form.get('memberEmail')?.errors"
          >
            <span
              *ngIf="form.get('memberEmail')?.errors?.['required']"
              style="color: var(--color-red)"
              >Email l√† b·∫Øt bu·ªôc.</span
            >
            <span *ngIf="form.get('memberEmail')?.errors?.['email']" style="color: var(--color-red)"
              >Email kh√¥ng h·ª£p l·ªá.</span
            >
            <span
              *ngIf="form.get('memberEmail')?.errors?.['duplicate']"
              style="color: var(--color-red)"
              >Email ƒë√£ t·ªìn t·∫°i.</span
            >
          </div>
        </div>

        <div class="col">
          <label>Role</label>
          <select formControlName="memberRole">
            <option *ngFor="let r of roleOptions" [value]="r">{{ r }}</option>
          </select>
        </div>
      </div>
      <div class="actions">
        <button type="button" class="btn btn-add" (click)="addMember()">Th√™m</button>

        <label class="upload-btn">
          <input type="file" accept=".csv,.txt" (change)="onFileChange($event)" hidden />
          <button type="button" class="btn btn-upload">T·∫£i l√™n danh s√°ch h·ªçc sinh</button>
        </label>
      </div>

      <div class="upload-error" *ngIf="uploadError">{{ uploadError }}</div>

      <div class="members-table">
        <table>
          <thead>
            <tr>
              <th>STT</th>
              <th>Email/username</th>
              <th>Role</th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let m of members; index as i">
              <td>{{ i + 1 }}</td>
              <td>{{ m.email }}</td>
              <td>{{ m.role }}</td>
              <td class="trash">
                <button type="button" (click)="removeMember(m.id)">üóëÔ∏è</button>
              </td>
            </tr>
            <tr *ngIf="members.length === 0">
              <td colspan="4" class="empty">Ch∆∞a c√≥ th√†nh vi√™n n√†o.</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="footer-actions">
      <button type="submit" class="btn btn-create">T·∫°o l·ªõp h·ªçc</button>
    </div>
  </form>
</div>
